!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("nanoid")):"function"==typeof define&&define.amd?define(["exports","nanoid"],n):n((t=t||self).domerjs={},t.nanoid)}(this,function(t,n){var e=[],r="",o=function(t,n){return Array.isArray(t)?-1!==t.indexOf(n):t===n};function i(){return window.location.pathname.replace(r,"")}function a(){var t=i(),n=e.every(function(n){return!o(n.path,t)});e.forEach(function(e){var r=e.path,i=e.element,a=e.parent,u=void 0===a?window.document.body:a;o(r,t)||n&&o(r,"")?u.append(i):u.contains(i)&&i.remove()})}function u(t){var n=""+r+t;window.history.pushState({path:n},"",n),a();var e=t.indexOf("#");if(-1!==e){var o=t.substring(e+1),i=window.document.getElementById(o);i&&window.scrollTo(0,i.offsetTop)}}window.addEventListener("popstate",function(){return a()});var c={__proto__:null,set:function(t,n,r){e.push({path:t,element:n,parent:r})},setBaseUrl:function(t){r=t},currentPath:i,apply:a,setRouteEl:function(t,n){return"A"===t.tagName&&(t.href=n),t.addEventListener("click",function(t){t.preventDefault(),u(n)}),t},push:u},s=window.__cache||[],f=[],d=1e5;function p(t,n,e){return void 0===e&&(e=d),new Promise(function(r){var o=s.find(function(n){return n.url===t});o&&Date.now()-e<o.time?r(n(o.data)):fetch(t).then(function(e){e.json().then(function(e){o?(o.data=e,o.time=Date.now()):s.push({url:t,data:e,time:Date.now()}),r(n(e))})})})}var l={__proto__:null,cache:s,setOptions:function(t){"number"==typeof t.refresh&&(d=t.refresh)},attach:function(t,n,e){void 0===e&&(e=d),f.push({url:t,func:n,refresh:e})},detach:function(t){var n=f.findIndex(function(n){return n.url===t});-1!==n&&f.splice(n,1)},apply:function(){var t=f.map(function(t){return p(t.url,t.func,t.refresh)});return Promise.all(t)},get:p};function h(){return(h=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t}).apply(this,arguments)}function v(t){for(;t.hasChildNodes();)t.removeChild(t.lastChild)}var y={__proto__:null,replaceStringArgs:function(t,n){var e=t;return Object.keys(n).forEach(function(t){"function"==typeof n[t]&&n[t](),e=e.replace("{{"+t+"}}",n[t])}),e},applyValue:function t(n){if("function"==typeof n){var e=n();return t.apply(void 0,[e].concat([].slice.call(arguments,1)))}return n},emptyChilds:v},w=window.__ssr||[],_=[],m=0;function E(t,e){void 0===e&&(e={});var r=e.attrs,o=void 0===r?{}:r,i=e.events,a=void 0===i?{}:i,u=e.dataset,c=void 0===u?{}:u,s=e.classList,f=void 0===s?[]:s,d=e.updateOn,p=null;if(window.isServer)(p=window.document.createElement(t)).__id=n.nanoid(6),p.dataset.ssrId=p.__id,w.push({id:p.__id,i:m});else{var l=w.find(function(t){return t.i===m});l&&(p=window.document.querySelector('[data-ssr-id="'+l.id+'"]'))&&(p.__id=l.id),p||((p=window.document.createElement(t)).__id=n.nanoid(6))}return _.push({el:p,options:e}),m++,g(p),Object.keys(o).forEach(function(t){return p.setAttribute(t,o[t])}),"string"==typeof f?p.classList.add(f):Array.isArray(f)&&f.forEach(function(t){return p.classList.add(t)}),Object.keys(c).forEach(function(t){return p.dataset[t]=c[t]}),Object.keys(a).forEach(function(t){return p.addEventListener(t,a[t])}),d&&j(d,p),p}function A(t,n){void 0===n&&(n=!1);var e=function(t,n){return t.__id===n.__id};if(n)return _.findIndex(function(n){return e(n.el,t)});var r=_.find(function(n){return e(n.el,t)});return r?r.options:void 0}var S=["INPUT","TEXTAREA"];function g(t,n){n&&function(t,n){var e=A(t,!0);-1!==e&&(_[e].options=h({},_[e].options,n))}(t,n);var e=A(t);!function t(n,e,r){if(e)if("function"!=typeof e){if("object"==typeof e)return v(n),void(Array.isArray(e)?e.forEach(function(t){return n.append(t)}):n.append(e));-1===S.indexOf(n.tagName)?r?n.innerHTML=e:n.textContent=e:n.value=e}else{var o=e(n);o&&t(n,o,r)}}(t,e.value,e.html)}var O=[],b={};function j(t,n){Array.isArray(t)?t.forEach(function(t){return j(t,n)}):Array.isArray(n)?n.forEach(function(n){return j(t,n)}):O.push({key:t,el:n})}var x={__proto__:null,assign:j,set:function(t,n){b[t]={updateFunc:n}},apply:function(t,n){var e=n,r=b[t];r&&(e=r.updateFunc),O.filter(function(n){return n.key===t}).forEach(function(t){var n=t.el;"function"==typeof e?e(n):g(n)})}},C=window.Element,L=C.prototype.append;C.prototype.append=function(){L.apply(this,Array.prototype.slice.call(arguments).filter(function(t){return!t.parentElement}))};var k=C.prototype.appendChild;C.prototype.appendChild=function(){arguments.parentElement||k.apply(this,arguments)},t.SSR=function(t){var n=t.src,e=E("link",{attrs:{rel:"stylesheet",href:t.stylesheet},useSSR:!1}),r=E("script",{attrs:{src:n},useSSR:!1}),o=E("script",{attrs:{type:"text/javascript"},value:"window.__ssr = "+JSON.stringify(w),useSSR:!1}),i=E("script",{attrs:{type:"text/javascript"},useSSR:!1});return{setUrl:function(t){return jsdom.reconfigure({url:"http://localhost"+t})},toHtml:function(){var t=window.document;return g(i,"window.__cache = "+JSON.stringify(s)),console.log(o.parentElement),t.head.append(e),t.body.append(o,i,r),"<!DOCTYPE html>"+t.documentElement.outerHTML}}},t.fetcher=l,t.helpers=y,t.newEl=E,t.newElClass=function(t,n,e){return void 0===e&&(e="div"),E(e,{classList:t,value:n})},t.router=c,t.updateEl=g,t.updater=x});
//# sourceMappingURL=domerjs.umd.js.map
