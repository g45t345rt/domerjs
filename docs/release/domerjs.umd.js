!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("nanoid")):"function"==typeof define&&define.amd?define(["exports","nanoid"],t):t((e=e||self).domerjs={},e.nanoid)}(this,function(e,t){var n=[],r="",o=function(e,t){return Array.isArray(e)?-1!==e.indexOf(t):e===t};function i(){var e=window.location.pathname.replace(r,""),t=n.every(function(t){return!o(t.path,e)});n.forEach(function(n){var r=n.path,i=n.element,a=n.parent,u=void 0===a?window.document.body:a;o(r,e)||t&&o(r,"")?u.append(i):u.contains(i)&&i.remove()})}function a(e){var t=""+r+e;window.history.pushState({path:t},"",t),i();var n=e.indexOf("#");if(-1!==n){var o=e.substring(n+1),a=window.document.getElementById(o);a&&window.scrollTo(0,a.offsetTop)}}window.addEventListener("popstate",function(){return i()});var u={__proto__:null,set:function(e,t,r){n.push({path:e,element:t,parent:r})},setBaseUrl:function(e){r=e},apply:i,setRouteEl:function(e,t){return"A"===e.tagName&&(e.href=t),e.addEventListener("click",function(e){e.preventDefault(),a(t)}),e},push:a},c=window.__cache||[],s=[],f=1e5;function d(e,t,n){return void 0===n&&(n=f),new Promise(function(r){var o=c.find(function(t){return t.url===e});o&&Date.now()-n<o.time?r(t(o.data)):fetch(e).then(function(n){n.json().then(function(n){o?(o.data=n,o.time=Date.now()):c.push({url:e,data:n,time:Date.now()}),r(t(n))})})})}var l={__proto__:null,cache:c,setOptions:function(e){"number"==typeof e.refresh&&(f=e.refresh)},attach:function(e,t,n){void 0===n&&(n=f),s.push({url:e,func:t,refresh:n})},detach:function(e){var t=s.findIndex(function(t){return t.url===e});-1!==t&&s.splice(t,1)},apply:function(){var e=s.map(function(e){return d(e.url,e.func,e.refresh)});return Promise.all(e)},get:d},p=window.__ssr||[],h=0;function v(e,n){void 0===n&&(n={});var r=null,o=n.attrs,i=void 0===o?{}:o,a=n.events,u=void 0===a?{}:a,c=n.dataset,s=void 0===c?{}:c,f=n.classList,d=void 0===f?[]:f,l=n.value,v=n.html,y=n.updateOn,w=n.useSSR,E=void 0===w||w,S={};if(E&&window.isServer)(r=window.document.createElement(e)).id=t.nanoid(5),p.push({id:r.id,i:h});else{var g=p.find(function(e){return e.i===h});g&&(r=window.document.getElementById(g.id)),r||(r=window.document.createElement(e))}return window.isServer&&!E&&(S.append=!1),h++,S.render={value:l,html:v},r.data=S,m(r),Object.keys(i).forEach(function(e){return r.setAttribute(e,i[e])}),"string"==typeof d?r.classList.add(d):Array.isArray(d)&&d.forEach(function(e){return r.classList.add(e)}),Object.keys(s).forEach(function(e){return r.dataset[e]=s[e]}),Object.keys(u).forEach(function(e){return r.addEventListener(e,u[e])}),y&&_(y,r),r}var y=["INPUT","TEXTAREA"];function m(e,t){var n=e.data.render,r=n.value,o=n.html;if(t&&(r=t),r)if("function"!=typeof r)-1===y.indexOf(e.tagName)?o?e.innerHTML=r:e.textContent=r:e.value=r;else{var i=r(e);i&&m(e,i)}}var w=[],E={};function _(e,t){Array.isArray(e)?e.forEach(function(e){return _(e,t)}):Array.isArray(t)?t.forEach(function(t){return _(e,t)}):w.push({key:e,el:t})}var S={__proto__:null,assign:_,set:function(e,t){E[e]={updateFunc:t}},apply:function(e,t){var n=t,r=E[e];r&&(n=r.updateFunc),w.filter(function(t){return t.key===e}).forEach(function(e){var t=e.el;"function"==typeof n?n(t):m(t)})}},g={__proto__:null,replaceStringArgs:function(e,t){var n=e;return Object.keys(t).forEach(function(e){"function"==typeof t[e]&&t[e](),n=n.replace("{{"+e+"}}",t[e])}),n},applyValue:function e(t){if("function"==typeof t){var n=t();return e.apply(void 0,[n].concat([].slice.call(arguments,1)))}return t},emptyChilds:function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild)}},A=window.Element,O=A.prototype.append;A.prototype.append=function(){O.apply(this,Array.prototype.slice.call(arguments).filter(function(e){return!e.parentElement}))};var b=A.prototype.appendChild;A.prototype.appendChild=function(){arguments.parentElement||b.apply(this,arguments)},e.SSR=function(e){var t=e.src,n=v("link",{attrs:{rel:"stylesheet",href:e.stylesheet},useSSR:!1}),r=v("script",{attrs:{src:t},useSSR:!1}),o=v("script",{attrs:{type:"text/javascript"},value:"window.__ssr = "+JSON.stringify(p),useSSR:!1}),i=v("script",{attrs:{type:"text/javascript"},useSSR:!1});return{setUrl:function(e){return jsdom.reconfigure({url:"http://localhost"+e})},toHtml:function(){var e=window.document;return m(i,"window.__cache = "+JSON.stringify(c)),console.log(o.parentElement),e.head.append(n),e.body.append(o,i,r),"<!DOCTYPE html>"+e.documentElement.outerHTML}}},e.fetcher=l,e.helpers=g,e.newEl=v,e.newElClass=function(e,t,n){return void 0===n&&(n="div"),v(n,{classList:e,value:t})},e.router=u,e.updateEl=m,e.updater=S});
//# sourceMappingURL=domerjs.umd.js.map
