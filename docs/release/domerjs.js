var t=require("nanoid"),e=[],n="",r=function(t,e){return Array.isArray(t)?-1!==t.indexOf(e):t===e};function o(){var t=window.location.pathname.replace(n,""),o=e.every(function(e){return!r(e.path,t)});e.forEach(function(e){var n=e.path,i=e.element,a=e.parent,u=void 0===a?window.document.body:a;r(n,t)||o&&r(n,"")?u.append(i):u.contains(i)&&i.remove()})}function i(t){var e=""+n+t;window.history.pushState({path:e},"",e),o();var r=t.indexOf("#");if(-1!==r){var i=t.substring(r+1),a=window.document.getElementById(i);a&&window.scrollTo(0,a.offsetTop)}}window.addEventListener("popstate",function(){return o()});var a={__proto__:null,set:function(t,n,r){e.push({path:t,element:n,parent:r})},setBaseUrl:function(t){n=t},apply:o,setRouteEl:function(t,e){return"A"===t.tagName&&(t.href=e),t.addEventListener("click",function(t){t.preventDefault(),i(e)}),t},push:i},u=window.__cache||[],c=[],s=1e5;function p(t,e,n){return void 0===n&&(n=s),new Promise(function(r){var o=u.find(function(e){return e.url===t});o&&Date.now()-n<o.time?r(e(o.data)):fetch(t).then(function(n){n.json().then(function(n){o?(o.data=n,o.time=Date.now()):u.push({url:t,data:n,time:Date.now()}),r(e(n))})})})}var l={__proto__:null,cache:u,setOptions:function(t){"number"==typeof t.refresh&&(s=t.refresh)},attach:function(t,e,n){void 0===n&&(n=s),c.push({url:t,func:e,refresh:n})},detach:function(t){var e=c.findIndex(function(e){return e.url===t});-1!==e&&c.splice(e,1)},apply:function(){var t=c.map(function(t){return p(t.url,t.func,t.refresh)});return Promise.all(t)},get:p},d=window.__ssr||[],f=0;function h(e,n){void 0===n&&(n={});var r=null,o=n.attrs,i=void 0===o?{}:o,a=n.events,u=void 0===a?{}:a,c=n.dataset,s=void 0===c?{}:c,p=n.classList,l=void 0===p?[]:p,h=n.value,v=n.html,w=n.updateOn,m=n.useSSR,_=void 0===m||m,S={};if(_&&window.isServer)(r=window.document.createElement(e)).id=t.nanoid(5),d.push({id:r.id,i:f});else{var x=d.find(function(t){return t.i===f});x&&(r=window.document.getElementById(x.id)),r||(r=window.document.createElement(e))}return window.isServer&&!_&&(S.append=!1),f++,S.render={value:h,html:v},r.data=S,y(r),Object.keys(i).forEach(function(t){return r.setAttribute(t,i[t])}),"string"==typeof l?r.classList.add(l):Array.isArray(l)&&l.forEach(function(t){return r.classList.add(t)}),Object.keys(s).forEach(function(t){return r.dataset[t]=s[t]}),Object.keys(u).forEach(function(t){return r.addEventListener(t,u[t])}),w&&E(w,r),r}var v=["INPUT","TEXTAREA"];function y(t,e){var n=t.data.render,r=n.value,o=n.html;if(e&&(r=e),r)if("function"!=typeof r)-1===v.indexOf(t.tagName)?o?t.innerHTML=r:t.textContent=r:t.value=r;else{var i=r(t);i&&y(t,i)}}var w=[],m={};function E(t,e){Array.isArray(t)?t.forEach(function(t){return E(t,e)}):Array.isArray(e)?e.forEach(function(e){return E(t,e)}):w.push({key:t,el:e})}var _={__proto__:null,assign:E,set:function(t,e){m[t]={updateFunc:e}},apply:function(t,e){var n=e,r=m[t];r&&(n=r.updateFunc),w.filter(function(e){return e.key===t}).forEach(function(t){var e=t.el;"function"==typeof n?n(e):y(e)})}},S={__proto__:null,replaceStringArgs:function(t,e){var n=t;return Object.keys(e).forEach(function(t){"function"==typeof e[t]&&e[t](),n=n.replace("{{"+t+"}}",e[t])}),n},applyValue:function t(e){if("function"==typeof e){var n=e();return t.apply(void 0,[n].concat([].slice.call(arguments,1)))}return e},emptyChilds:function(t){for(;t.hasChildNodes();)t.removeChild(t.lastChild)}},x=window.Element,g=x.prototype.append;x.prototype.append=function(){g.apply(this,Array.prototype.slice.call(arguments).filter(function(t){return!t.parentElement}))};var A=x.prototype.appendChild;x.prototype.appendChild=function(){arguments.parentElement||A.apply(this,arguments)},exports.SSR=function(t){var e=t.src,n=h("link",{attrs:{rel:"stylesheet",href:t.stylesheet},useSSR:!1}),r=h("script",{attrs:{src:e},useSSR:!1}),o=h("script",{attrs:{type:"text/javascript"},value:"window.__ssr = "+JSON.stringify(d),useSSR:!1}),i=h("script",{attrs:{type:"text/javascript"},useSSR:!1});return{setUrl:function(t){return jsdom.reconfigure({url:"http://localhost"+t})},toHtml:function(){var t=window.document;return y(i,"window.__cache = "+JSON.stringify(u)),console.log(o.parentElement),t.head.append(n),t.body.append(o,i,r),"<!DOCTYPE html>"+t.documentElement.outerHTML}}},exports.fetcher=l,exports.helpers=S,exports.newEl=h,exports.newElClass=function(t,e,n){return void 0===n&&(n="div"),h(n,{classList:t,value:e})},exports.router=a,exports.updateEl=y,exports.updater=_;
//# sourceMappingURL=domerjs.js.map
